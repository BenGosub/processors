# Tasks

build:
  - docker build -t opentrialsrobot/warehouse .

deploy:
  - ${CI?"Deployment is avaiable only on CI/CD server"}
  - docker login
    -e $OPENTRIALS_DOCKER_EMAIL
    -u $OPENTRIALS_DOCKER_USER
    -p $OPENTRIALS_DOCKER_PASS
  - tutum login
    -u $OPENTRIALS_DOCKER_USER
    -p $OPENTRIALS_DOCKER_PASS
  - docker push opentrialsrobot/warehouse
  # Stacks
  - tutum stack inspect mapper ||
    tutum stack create --sync -f stacks/mapper.yml -n mapper
  - tutum stack update --sync -f stacks/mapper.yml mapper

review:
  - pylama warehouse

test:
  - py.test -vs tests
