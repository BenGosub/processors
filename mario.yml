# Tasks

build:
  - docker build -t opentrialsrobot/warehouse .

deploy:
  - ${CI?"Deployment is avaiable only on CI/CD server"}
  - docker login
    -e $OPENTRIALS_DOCKER_EMAIL
    -u $OPENTRIALS_DOCKER_USER
    -p $OPENTRIALS_DOCKER_PASS
  - tutum login
    -u $OPENTRIALS_DOCKER_USER
    -p $OPENTRIALS_DOCKER_PASS
  - docker push opentrialsrobot/warehouse
  # Stacks
  - tutum stack inspect warehouse-database ||
    tutum stack create --sync -f stacks/database.yml -n warehouse-database
  - tutum stack update --sync -f stacks/database.yml warehouse-database

test:
  - echo 'no-op'
  # - pylama warehouse
  # - py.test -vs tests
